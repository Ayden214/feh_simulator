<!--
index.html
----------
Homepage template rendered by Flask.
Displays dropdowns for selecting attacker and defender units, 
and a submit button to calculate battle results.
-->

{% extends "base.html" %}
{% block content %}
<h1 style="text-align:center;margin-bottom:24px;">Fire Emblem Heroes Battle Simulator</h1>
<form method="POST" style="max-width:1200px;margin:auto;">
  <div class="feh-flex">
    <div class="feh-hero-img feh-hero-img-large feh-hero-img-left" id="attacker-img" style="min-width:640px;min-height:750px;">
      <img src="/static/img/placeholder.png" alt="No unit selected" width="640" height="750" style="border-radius:12px;opacity:0.5;">
    </div>
    <div class="feh-column">
      <h2 class="feh-header">Attacker</h2>
      <div class="feh-group">
        <div class="feh-hero-info" id="attacker-info"></div>
        <label for="attacker">Unit:</label>
        <select name="attacker" id="attacker" onchange="showUnitInfo('attacker', this.value)">
          <option value="None" {% if request.form.get('attacker', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for unit in units %}
          <option value="{{ unit.name }}" {% if request.form.get('attacker', 'None') == unit.name %}selected{% endif %}>{{ unit.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group">
        <label for="attacker_weapon">Weapon:</label>
        <select name="attacker_weapon" id="attacker_weapon">
          <option value="None" {% if request.form.get('attacker_weapon', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for weapon in weapons %}
          <option value="{{ weapon.name }}" {% if request.form.get('attacker_weapon', 'None') == weapon.name %}selected{% endif %} title="Type: {{ weapon.weapon_type }}, Mt: {{ weapon.might }}, Color: {{ weapon.color }}, Rng: {{ weapon.range }}">{{ weapon.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group">
        <label for="attacker_special">Special:</label>
        <select name="attacker_special" id="attacker_special">
          <option value="None" {% if request.form.get('attacker_special', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'Special' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_special', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group feh-skills">
        <label for="attacker_a">A Slot:</label>
        <select name="attacker_a" id="attacker_a">
          <option value="None" {% if request.form.get('attacker_a', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'A' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_a', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="attacker_b">B Slot:</label>
        <select name="attacker_b" id="attacker_b">
          <option value="None" {% if request.form.get('attacker_b', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'B' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_b', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="attacker_c">C Slot:</label>
        <select name="attacker_c" id="attacker_c">
          <option value="None" {% if request.form.get('attacker_c', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'C' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_c', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="attacker_seal">Seal:</label>
        <select name="attacker_seal" id="attacker_seal">
          <option value="None" {% if request.form.get('attacker_seal', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'Seal' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_seal', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="attacker_x">X Slot:</label>
        <select name="attacker_x" id="attacker_x">
          <option value="None" {% if request.form.get('attacker_x', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'X' %}
          <option value="{{ skill.name }}" {% if request.form.get('attacker_x', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="feh-column">
      <h2 class="feh-header">Defender</h2>
      <div class="feh-group">
        <div class="feh-hero-info" id="defender-info"></div>
      </div>
      <div class="feh-group">
        <label for="defender">Unit:</label>
        <select name="defender" id="defender" onchange="showUnitInfo('defender', this.value)">
          <option value="None" {% if request.form.get('defender', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for unit in units %}
          <option value="{{ unit.name }}" {% if request.form.get('defender', 'None') == unit.name %}selected{% endif %}>{{ unit.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group">
        <label for="defender_weapon">Weapon:</label>
        <select name="defender_weapon" id="defender_weapon">
          <option value="None" {% if request.form.get('defender_weapon', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for weapon in weapons %}
          <option value="{{ weapon.name }}" {% if request.form.get('defender_weapon', 'None') == weapon.name %}selected{% endif %} title="Type: {{ weapon.weapon_type }}, Mt: {{ weapon.might }}, Color: {{ weapon.color }}, Rng: {{ weapon.range }}">{{ weapon.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group">
        <label for="defender_special">Special:</label>
        <select name="defender_special" id="defender_special">
          <option value="None" {% if request.form.get('defender_special', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'Special' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_special', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="feh-group feh-skills">
        <label for="defender_a">A Slot:</label>
        <select name="defender_a" id="defender_a">
          <option value="None" {% if request.form.get('defender_a', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'A' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_a', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="defender_b">B Slot:</label>
        <select name="defender_b" id="defender_b">
          <option value="None" {% if request.form.get('defender_b', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'B' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_b', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="defender_c">C Slot:</label>
        <select name="defender_c" id="defender_c">
          <option value="None" {% if request.form.get('defender_c', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'C' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_c', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="defender_seal">Seal:</label>
        <select name="defender_seal" id="defender_seal">
          <option value="None" {% if request.form.get('defender_seal', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'Seal' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_seal', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
        <label for="defender_x">X Slot:</label>
        <select name="defender_x" id="defender_x">
          <option value="None" {% if request.form.get('defender_x', 'None') == 'None' %}selected{% endif %}>None</option>
          {% for skill in skills if skill.skill_type == 'X' %}
          <option value="{{ skill.name }}" {% if request.form.get('defender_x', 'None') == skill.name %}selected{% endif %} title="{{ skill.description }}">{{ skill.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="feh-hero-img feh-hero-img-large feh-hero-img-right" id="defender-img" style="min-width:640px;min-height:750px;">
      <img src="/static/img/placeholder.png" alt="No unit selected" width="640" height="750" style="border-radius:12px;opacity:0.5;">
    </div>
  </div>
  <br>
  <textarea id="combat-text" readonly style="width:100%;height:120px;font-size:18px;margin-top:20px;resize:none;">{{ result if result else 'Select options to see combat results.' }}</textarea>
</form>
<script>
window.units = {{ units|tojson }};
window.weapons = {{ weapons|tojson }};
window.skills = {{ skills|tojson }};
</script>
{% endblock %}
