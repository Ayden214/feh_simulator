<!-- admin.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FEH Admin Panel</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const typeSelect = document.getElementById('delete_type');
      const nameSelect = document.getElementById('delete_name');
      const unitNames = [{% for unit in units %}'{{ unit.name }}',{% endfor %}];
      const weaponNames = [{% for weapon in weapons %}'{{ weapon.name }}',{% endfor %}];
      const skillNames = [{% for skill in skills %}'{{ skill.name }}',{% endfor %}];

      function updateNameOptions() {
        let selectedType = typeSelect.value;
        let names = [];
        if (selectedType === 'unit') {
          names = unitNames;
        } else if (selectedType === 'weapon') {
          names = weaponNames;
        } else if (selectedType === 'skill') {
          names = skillNames;
        }
        nameSelect.innerHTML = '';
        names.forEach(function(name) {
          let opt = document.createElement('option');
          opt.value = name;
          opt.textContent = name;
          nameSelect.appendChild(opt);
        });
      }
      typeSelect.addEventListener('change', updateNameOptions);
      updateNameOptions(); // Initial population
    });
  </script>
  <h1>Admin: Add/Delete Units, Weapons, Skills</h1>
  <h2>Delete Entry</h2>
  <form method="POST" action="/admin?type=delete">
    <label for="delete_type">Type:</label>
    <select name="delete_type" id="delete_type">
      <option value="unit">Unit</option>
      <option value="weapon">Weapon</option>
      <option value="skill">Skill</option>
    </select>
    <label for="delete_name">Name:</label>
    <select name="delete_name" id="delete_name">
      {% if delete_type == 'unit' or not delete_type %}
        {% for unit in units %}
        <option value="{{ unit.name }}">{{ unit.name }}</option>
        {% endfor %}
      {% elif delete_type == 'weapon' %}
        {% for weapon in weapons %}
        <option value="{{ weapon.name }}">{{ weapon.name }}</option>
        {% endfor %}
      {% elif delete_type == 'skill' %}
        {% for skill in skills %}
        <option value="{{ skill.name }}">{{ skill.name }}</option>
        {% endfor %}
      {% endif %}
    </select>
    <button type="submit">Delete</button>
  </form>
  <h2>Add Unit</h2>
  <form method="POST" action="/admin?type=unit">
    <input name="name" placeholder="Name" required>
    <input name="hp" type="number" placeholder="HP" required>
    <input name="atk" type="number" placeholder="Atk" required>
    <input name="spd" type="number" placeholder="Spd" required>
    <input name="defense" type="number" placeholder="Def" required>
    <input name="res" type="number" placeholder="Res" required>
    <label for="superboons">Superboons (comma separated):</label>
    <input name="superboons" placeholder="e.g. atk,spd">
    <label for="superbanes">Superbanes (comma separated):</label>
    <input name="superbanes" placeholder="e.g. hp,res">
    <label for="exclusive_skills">Exclusive Skills (comma separated):</label>
    <input name="exclusive_skills" placeholder="e.g. Ragnell, Radiant Aether">
    <label for="image_url">Image URL:</label>
    <input name="image_url" placeholder="Image URL">
    <label for="unit_type">Movement Type:</label>
    <select name="unit_type" id="unit_type">
      <option value="infantry">Infantry</option>
      <option value="armor">Armor</option>
      <option value="flier">Flier</option>
      <option value="cavalry">Cavalry</option>
    </select>
    <label for="weapon_type">Weapon Type:</label>
    <select name="weapon_type" id="weapon_type">
      <option value="Sword">Sword</option>
      <option value="Lance">Lance</option>
      <option value="Axe">Axe</option>
      <option value="Bow">Bow</option>
      <option value="Dagger">Dagger</option>
      <option value="Tome">Tome</option>
      <option value="Staff">Staff</option>
      <option value="Beast">Beast</option>
      <option value="Breath">Breath</option>
    </select>
  <!-- <input name="image_url" placeholder="Image URL"> -->
    <button type="submit">Add Unit</button>
  </form>

  <h2>Add Weapon</h2>
  <form method="POST" action="/admin?type=weapon">
    <input name="name" placeholder="Name" required>
    <input name="might" type="number" placeholder="Might" required>
    <label for="color">Color:</label>
    <select name="color" id="color">
      <option value="blue">Blue</option>
      <option value="red">Red</option>
      <option value="green">Green</option>
      <option value="colorless">Colorless</option>
    </select>
    <input name="range" type="number" placeholder="Range" required>
    <label for="weapon_type">Weapon Type:</label>
    <select name="weapon_type" id="weapon_type">
      <option value="Breath">Breath</option>
      <option value="Beast">Beast</option>
      <option value="Dagger">Dagger</option>
      <option value="Bow">Bow</option>
      <option value="Tome">Tome</option>
      <option value="Staff">Staff</option>
      <option value="Sword">Sword</option>
      <option value="Axe">Axe</option>
      <option value="Lance">Lance</option>
    </select>
    <label for="effective_against">Effective Against:</label>
    <select name="effective_against" id="effective_against" multiple>
      <!-- Movement types -->
      <option value="infantry">Infantry</option>
      <option value="armor">Armor</option>
      <option value="flier">Flier</option>
      <option value="cavalry">Cavalry</option>
      <!-- Weapon types -->
      <option value="Breath">Breath</option>
      <option value="Beast">Beast</option>
      <option value="Dagger">Dagger</option>
      <option value="Bow">Bow</option>
      <option value="Tome">Tome</option>
      <option value="Staff">Staff</option>
      <option value="Sword">Sword</option>
      <option value="Axe">Axe</option>
      <option value="Lance">Lance</option>
    </select>
  <!-- <input name="image_url" placeholder="Image URL"> -->
    <button type="submit">Add Weapon</button>
  </form>

  <h2>Add Skill</h2>
  <form method="POST" action="/admin?type=skill">
    <input name="name" placeholder="Name" required>
    <input name="description" placeholder="Description">
    <input name="skill_type" placeholder="Type (special, passive, etc)">
    <input name="effect_json" placeholder="Effect JSON">
    <button type="submit">Add Skill</button>
  </form>

  {% if message %}
  <p><strong>{{ message }}</strong></p>
  {% endif %}
</body>
</html>
